// media.js v0.5.10 Copyright (C) 2013 Visman (visman@inbox.ru)
if("undefined"===typeof FluxBB||!FluxBB)var FluxBB={};FluxBB.media=function(){function p(e){return k.createElementNS?k.createElementNS("http://www.w3.org/1999/xhtml",e):k.createElement(e)}function n(e,c,b,a,g){b=b||{};a=a||{};c=p(c);for(var d in b)b.hasOwnProperty(d)&&("style"==d?c.style.cssText=b[d]:c.setAttribute(d,b[d]));for(d in a)a.hasOwnProperty(d)&&(b=p("param"),b.setAttribute("name",d),b.setAttribute("value",a[d]),c.appendChild(b));if(!g)return e.appendChild(c);a=e.parentNode;return(e=e.nextSibling)?a.insertBefore(c,e):a.appendChild(c)}function g(e,c,b,a){var g,d,h;a=a||{};if(a[l]&&(h=a[l].split(":"),h[0]>=q))if(c[h[1]])d=h[1];else return;!d&&c.iframe&&(d="iframe");d||(d="object");b=b||{};b.wt=b.wt||640;b.ht=b.ht||360;"ie"==l&&"object"==d&&(g=1,b.tp=b.tp||2);a=c[d][0];c=c[d][1]?c[d][1]:{};"iframe"==d?a.frameborder="0":(a.type="application/x-shockwave-flash",c.wmode="transparent");a.id="mediajs"+t++;2==b.tp?(h=e.parentNode.clientWidth||e.parentNode.offsetWidth,h<b.wt&&(b.ht=parseInt(b.ht*h/b.wt),b.wt=h),a.width=b.wt,a.height=b.ht,h={style:"padding-top:5px;"},b={}):1==b.tp?(a.width="100%",a.height=b.ht,h={style:"padding-top:5px;overflow:hidden;position:relative;"+("string"==typeof b.wt?"width:"+b.wt+";":"max-width:"+b.wt+"px;")},b={style:"height:"+b.ht+";overflow:hidden;position:relative;"}):(a.style="position:absolute;left:0;top:0;width:100%;height:100%;",h={style:"padding-top:5px;overflow:hidden;position:relative;max-width:"+b.wt+"px;"},b={style:"overflow:hidden;position:relative;height:0;padding-bottom:"+100*b.ht/b.wt+"%;"});if(g){d=g="";for(var f in a)a.hasOwnProperty(f)&&("data"==f?c.movie=a[f]:"type"!=f&&(g+=" "+f+'="'+a[f]+'"'));for(f in c)c.hasOwnProperty(f)&&(d+='<param name="'+f+'" value="'+c[f]+'" />');e.parentNode.outerHTML=e.parentNode.outerHTML.replace(e.outerHTML,e.outerHTML+'<div style="padding-top:5px;"><object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+g+">"+d+"</object></div>")}else n(n(n(e,"div",h,{},!0),"div",b),d,a,c)}var t=0,k=document,r=window,l=r.ActiveXObject?"ie":"unknown",q="ie"!=l?0:k.addEventListener?9:k.querySelector?8:r.XMLHttpRequest?7:k.compatMode?6:0,s="ie"==l&&9>q;return{init:function(){if(/in/.test(k.readyState))setTimeout(FluxBB.media.init,100);else{var e;e=(e=k.getElementById("brdmain"))||k;if(e.querySelectorAll)e=e.querySelectorAll(".postmsg");else if(e.getElementsByClassName)e=e.getElementsByClassName("postmsg");else{e=e.all||e.getElementsByTagName("*");for(var c=[],b=0,a;a=e[b++];)a.className&&-1<(" "+a.className+" ").indexOf(" postmsg ")&&(c[c.length]=a);e=c}for(var l in e)if(e[l].className&&!(-1<(" "+e[l].className+ " ").indexOf(" postsignature "))){var c=e[l].getElementsByTagName("a"),d;for(d in c){if(b=c[d].href)if(b=!c[d].nextSibling||c[d].nextSibling.tagName&&"BR"==c[d].nextSibling.tagName.toUpperCase())if(b=!c[d].previousSibling||c[d].previousSibling.tagName&&"BR"==c[d].previousSibling.tagName.toUpperCase()){b=c[d];if(b.children){b=b.childNodes;a=b.length;for(var h=0;a--;)1==b[a].nodeType&&h++;b=h}else b=b.childElementCount;b=0==b&&"P"==c[d].parentNode.tagName.toUpperCase()}if(b){var b=c[d],f=h=a=void 0, m=b.href;(a=m.split("re.php?u="))&&a[1]&&(m=decodeURIComponent(a[1]).replace(/(https?|ftp)___/g,"$1://"));m=m.replace(/&amp;/g,"&");if(h=m.match(/^(https?:\/\/)(www\.)?(.+)$/))f=h[3],(a=f.match(/^(youtube\.com\/.*v=|youtu\.be\/)([-\w]+)/))?g(b,{iframe:[{src:h[1]+"www.youtube.com/embed/"+a[2]+"?wmode=transparent",allowfullscreen:"true"}]}):(a=f.match(/^(player\.)?vimeo\.com\/(\d+)/))?g(b,{iframe:[{src:h[1]+"player.vimeo.com/video/"+a[2],allowfullscreen:"true"}]}):(a=f.match(/^dailymotion\.com\/video\/([a-zA-Z\d]+)_/))?g(b,{iframe:[{src:"http://www.dailymotion.com/embed/video/"+a[1]+'?theme=none"',allowfullscreen:"true"}]}):(a=f.match(/^rutube\.ru\/tracks\/(\d+)\.html\?v=([a-zA-Z\d]+)/))?g(b,{object:[{data:"http://video.rutube.ru/"+a[2]},{allowFullScreen:"true",allowScriptAccess:"always"}]}):(a=f.match(/^(rutube\.ru\/video\/embed|video\.rutube\.ru)\/(\d+)/))?g(b,{iframe:[{src:"http://rutube.ru/video/embed/"+a[2],allowfullscreen:"true"}],object:[{data:"http://video.rutube.ru/"+a[2]},{allowFullScreen:"true",allowScriptAccess:"always"}]},{},{ie:"7:object"}):(a=f.match(/^rutube\.ru\/video\/([a-zA-Z\d]+)/))?g(b,{iframe:[{src:"http://rutube.ru/video/embed/"+a[1],allowfullscreen:"true"}],object:[{data:"http://video.rutube.ru/"+a[1]},{allowFullScreen:"true",allowScriptAccess:"always"}]},{},{ie:"7:object"}):(a=f.match(/^(static\.)?video\.yandex\.ru\/(iframe|lite)\/([-\w\.\/]+)\//))?g(b,{iframe:[{src:"http://video.yandex.ru/iframe/"+a[3],allowfullscreen:"true"}]}):(a=f.match(/^video\.mail\.ru\/([-\w]+)\/([-\w]+)\/([-\w]+)\/([-\w]+)\.html/))?g(b,{object:[{data:"http://img.mail.ru/r/video2/uvpv3.swf?2"},{allowFullScreen:"true",allowScriptAccess:"always",flashvars:"movieSrc="+a[1]+"/"+a[2]+"/"+a[3]+"/"+a[4]+"&autoplay=0"}]}):(a=f.match(/^smotri\.com\/video\/view\/\?id=([a-zA-Z\d]+)/))?g(b,{object:[{data:"http://pics.smotri.com/player.swf?file="+a[1]+"&bufferTime=3&autoStart=false&str_lang=rus"},{allowFullScreen:"true",allowScriptAccess:"always"}]}):f.match(/^([^\\\?\s<>"'&]+\.mp3)$/)?g(b,{object:[{data:"swf/mp3player.swf"},{FlashVars:"soundFile="+m,quality:"high",menu:"false"}]},{wt:"100%",ht:24,tp:1}):(a=f.match(/^(soundcloud\.com\/[-\w]+\/(sets\/)?[-\w]+|api\.soundcloud\.com\/(tracks|playlists)\/\d+)/))?g(b,{iframe:[{src:"https://w.soundcloud.com/player/?sharing=false&liking=false&show_playcount=false&show_comments=false&url="+m,scrolling:"no"}]},{wt:"100%",ht:a[2]||"playlists"==a[3]?s?225:450:s?81:166,tp:1}):(a=f.match(/^maps\.google\.([a-z]+)\/([a-z\d\?\.,\&\=]+)$/))?g(b,{iframe:[{src:"https://maps.google."+a[1]+"/"+a[2]+"&ie=UTF8&output=embed",scrolling:"no",marginheight:"0",marginwidth:"0"}]},{wt:410,ht:350,tp:2}):(a=f.match(/^www(\d+)\.zippyshare\.com\/v(\/|.*key=)(\d+)/))?g(b,{object:[{data:"http://www"+a[1]+".zippyshare.com/swf/player_local.swf?file="+a[3]+"&server="+a[1]+"&baseurl=http://www.zippyshare.com/api/&flashid=null&autostart=false&availablequality=both"},{allowScriptAccess:"always",allowFullScreen:"false"}]},{wt:"100%",ht:80,tp:1}):(a=f.match(/^metacafe\.com\/watch\/([-\w]+)/))?g(b,{iframe:[{src:"http://www.metacafe.com/embed/"+a[1]+"/",allowfullscreen:"true"}]}):(a=f.match(/^video\.sibnet\.ru\/video(\d+)/))?g(b,{iframe:[{src:"http://video.sibnet.ru/shell.php?videoid="+a[1]+"/",allowfullscreen:"true",scrolling:"no"}]}):(a=f.match(/^promodj\.com\/([^\/]+\/[^\/]+|download|embed)\/(\d+)/))?g(b,{iframe:[{src:"http://promodj.com/embed/"+a[2]+"/big",allowfullscreen:"true"}]},{wt:"100%",ht:70,tp:1}):(a=f.match(/^(embed\.)?pleer\.com\/track(s\/|\?id=)(\w+)/))?g(b,{object:[{data:"http://embed.pleer.com/track?id="+a[3]}]},{wt:"100%", ht:42,tp:1}):(a=f.match(/^(embed\.)?pleer\.com\/list(\?id=)?(\w+)/))&&g(b,{object:[{data:"http://embed.pleer.com/list?id="+a[3]}]},{wt:"100%",ht:300,tp:1})}}}}}}}();FluxBB.media.init();