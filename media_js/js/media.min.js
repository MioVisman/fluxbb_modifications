// media.js v0.6.0 Copyright (C) 2013 Visman (visman@inbox.ru)
if("undefined"===typeof FluxBB||!FluxBB)var FluxBB={};FluxBB.media=function(){function p(f){return l.createElementNS?l.createElementNS("http://www.w3.org/1999/xhtml",f):l.createElement(f)}function n(f,d,b,a,c){if("string"!==typeof d)return f.appendChild(d);b=b||{};a=a||{};d=p(d);for(var e in b)b.hasOwnProperty(e)&&("style"==e?d.style.cssText=b[e]:d.setAttribute(e,b[e]));for(e in a)a.hasOwnProperty(e)&&(b=p("param"),b.setAttribute("name",e),b.setAttribute("value",a[e]),d.appendChild(b));if(!c)return f.appendChild(d);a=f.parentNode;return(f=f.nextSibling)?a.insertBefore(d,f):a.appendChild(d)}function c(f,d,b,a){var c;a=a||{};if(a[m]&&(a=a[m].split(":"),a[0]>=q))if(d[a[1]])c=a[1];else return;!c&&d.iframe&&(c="iframe");c||(c="object");b=b||{};b.wt=b.wt||640;b.ht=b.ht||360;var e=d[c][0],k=d[c][1]?d[c][1]:{};"iframe"==c?e.frameborder="0":(e.type="application/x-shockwave-flash",k.wmode="transparent");e.id="mediajs"+t++;2==b.tp?(a=f.parentNode.clientWidth||f.parentNode.offsetWidth,a<b.wt&&(b.ht=parseInt(b.ht*a/b.wt),b.wt=a),e.width=b.wt,e.height=b.ht,d={style:"padding-top:5px;"},b={}):1==b.tp?(e.width="100%",e.height=b.ht,d={style:"padding-top:5px;overflow:hidden;position:relative;"+("string"==typeof b.wt?"width:"+b.wt+";":"max-width:"+b.wt+"px;")},b={style:"height:"+b.ht+";overflow:hidden;position:relative;"}):(e.style="position:absolute;left:0;top:0;width:100%;height:100%;",d={style:"padding-top:5px;overflow:hidden;position:relative;max-width:"+b.wt+"px;"},b={style:"overflow:hidden;position:relative;height:0;padding-bottom:"+100*b.ht/b.wt+"%;"});if("ie"==m&&"object"==c){var g=c="",h;for(h in e)e.hasOwnProperty(h)&&("data"==h?k.movie=e[h]:"type"!=h&&(c+=" "+h+'="'+e[h]+'"'));for(h in k)k.hasOwnProperty(h)&&(g+='<param name="'+h+'" value="'+k[h]+'" />');a=l.createElement("div");a.innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+c+">"+g+"</object>";c=a.firstChild;a.removeChild(c)}n(n(n(f,"div",d,{},!0),"div",b),c,e,k);f.className+=(f.className?" ":"")+"mediajslink"}var t=0,l=document,r=window,m=r.ActiveXObject?"ie":"unknown", q="ie"!=m?0:l.addEventListener?9:l.querySelector?8:r.XMLHttpRequest?7:l.compatMode?6:0,s="ie"==m&&9>q;return{run:function(){var f;f=(f=l.getElementById("brdmain"))||l;if(f.querySelectorAll)f=f.querySelectorAll(".postmsg");else if(f.getElementsByClassName)f=f.getElementsByClassName("postmsg");else{f=f.all||f.getElementsByTagName("*");for(var d=[],b=0,a;a=f[b++];)a.className&&-1<(" "+a.className+" ").indexOf(" postmsg ")&&(d[d.length]=a);f=d}for(var m in f)if(f[m].className&&!(-1<(" "+f[m].className+" ").indexOf(" postsignature "))){var d=f[m].getElementsByTagName("a"),e;for(e in d){if(b=d[e].href)if(b=!d[e].nextSibling||d[e].nextSibling.tagName&&"BR"==d[e].nextSibling.tagName.toUpperCase())if(b=!d[e].previousSibling||d[e].previousSibling.tagName&&"BR"==d[e].previousSibling.tagName.toUpperCase()){b=d[e];if(b.children){b=b.childNodes;a=b.length;for(var k=0;a--;)1==b[a].nodeType&&k++;b=k}else b=b.childElementCount;b=0==b&&"P"==d[e].parentNode.tagName.toUpperCase()}if(b){var b=d[e],g=k=a=void 0,h=b.href;(a=h.split("re.php?u="))&&a[1]&&(h=decodeURIComponent(a[1]).replace(/(https?|ftp)___/g,"$1://"));h=h.replace(/&amp;/g,"&");if(k=h.match(/^(https?:\/\/)(www\.)?(.+)$/))g=k[3],(a=g.match(/^(youtube\.com\/.*v=|youtu\.be\/)([-\w]+)/))?c(b,{iframe:[{src:k[1]+"www.youtube.com/embed/"+a[2]+"?wmode=transparent",allowfullscreen:"true"}]}):(a=g.match(/^(player\.)?vimeo\.com\/(\d+)/))?c(b,{iframe:[{src:k[1]+"player.vimeo.com/video/"+a[2],allowfullscreen:"true"}]}):(a=g.match(/^dailymotion\.com\/video\/([a-zA-Z\d]+)_/))?c(b,{iframe:[{src:"http://www.dailymotion.com/embed/video/"+a[1]+'?theme=none"',allowfullscreen:"true"}]}):(a=g.match(/^rutube\.ru\/tracks\/(\d+)\.html\?v=([a-zA-Z\d]+)/))?c(b,{object:[{data:"http://video.rutube.ru/"+a[2]},{allowFullScreen:"true",allowScriptAccess:"always"}]}):(a=g.match(/^(rutube\.ru\/video\/embed|video\.rutube\.ru)\/(\d+)/))?c(b,{iframe:[{src:"http://rutube.ru/video/embed/"+a[2],allowfullscreen:"true"}],object:[{data:"http://video.rutube.ru/"+a[2]},{allowFullScreen:"true",allowScriptAccess:"always"}]},{},{ie:"7:object"}):(a=g.match(/^rutube\.ru\/video\/([a-zA-Z\d]+)/))?c(b,{iframe:[{src:"http://rutube.ru/video/embed/"+a[1],allowfullscreen:"true"}],object:[{data:"http://video.rutube.ru/"+a[1]},{allowFullScreen:"true",allowScriptAccess:"always"}]},{},{ie:"7:object"}):(a=g.match(/^(static\.)?video\.yandex\.ru\/(iframe|lite)\/([-\w\.\/]+)\//))?c(b,{iframe:[{src:"http://video.yandex.ru/iframe/"+a[3],allowfullscreen:"true"}]}):(a=g.match(/^video\.mail\.ru\/([-\w]+)\/([-\w]+)\/([-\w]+)\/([-\w]+)\.html/))?c(b,{object:[{data:"http://img.mail.ru/r/video2/uvpv3.swf?2"},{allowFullScreen:"true",allowScriptAccess:"always",flashvars:"movieSrc="+a[1]+"/"+a[2]+"/"+a[3]+"/"+a[4]+"&autoplay=0"}]}):(a=g.match(/^smotri\.com\/video\/view\/\?id=([a-zA-Z\d]+)/))?c(b,{object:[{data:"http://pics.smotri.com/player.swf?file="+a[1]+"&bufferTime=3&autoStart=false&str_lang=rus"},{allowFullScreen:"true",allowScriptAccess:"always"}]}):g.match(/^([^\\\?\s<>"'&]+\.mp3)$/)?c(b,{object:[{data:"swf/mp3player.swf"},{FlashVars:"soundFile="+h,quality:"high",menu:"false"}]},{wt:"100%",ht:24,tp:1}):(a=g.match(/^(soundcloud\.com\/[-\w]+\/(sets\/)?[-\w]+|api\.soundcloud\.com\/(tracks|playlists)\/\d+)/))?c(b,{iframe:[{src:"https://w.soundcloud.com/player/?sharing=false&liking=false&show_playcount=false&show_comments=false&url="+h,scrolling:"no"}]},{wt:"100%",ht:a[2]||"playlists"==a[3]?s?225:450:s?81:166,tp:1}):(a=g.match(/^maps\.google\.([a-z]+)\/([a-z\d\?\.,\&\=]+)$/))?c(b,{iframe:[{src:"https://maps.google."+a[1]+"/"+a[2]+"&ie=UTF8&output=embed",scrolling:"no",marginheight:"0",marginwidth:"0"}]},{wt:410,ht:350,tp:2}):(a=g.match(/^www(\d+)\.zippyshare\.com\/v(\/|.*key=)(\d+)/))?c(b,{object:[{data:"http://www"+a[1]+".zippyshare.com/swf/player_local.swf?file="+a[3]+"&server="+a[1]+"&baseurl=http://www.zippyshare.com/api/&flashid=null&autostart=false&availablequality=both"},{allowScriptAccess:"always",allowFullScreen:"false"}]},{wt:"100%",ht:80,tp:1}):(a=g.match(/^metacafe\.com\/watch\/([-\w]+)/))?c(b,{iframe:[{src:"http://www.metacafe.com/embed/"+a[1]+"/",allowfullscreen:"true"}]}):(a=g.match(/^video\.sibnet\.ru\/video(\d+)/))?c(b,{iframe:[{src:"http://video.sibnet.ru/shell.php?videoid="+a[1]+"/",allowfullscreen:"true",scrolling:"no"}]}):(a=g.match(/^promodj\.com\/([^\/]+\/[^\/]+|download|embed)\/(\d+)/))?c(b,{iframe:[{src:"http://promodj.com/embed/"+a[2]+"/big",allowfullscreen:"true"}]},{wt:"100%",ht:70,tp:1}):(a=g.match(/^(embed\.)?pleer\.com\/track(s\/|\?id=)(\w+)/))?c(b,{object:[{data:"http://embed.pleer.com/track?id="+a[3]}]},{wt:"100%",ht:42,tp:1}):(a=g.match(/^(embed\.)?pleer\.com\/list(\?id=)?(\w+)/))?c(b,{object:[{data:"http://embed.pleer.com/list?id="+a[3]}]},{wt:"100%",ht:300,tp:1}):(a=g.match(/^([a-z]{1,3}\.)?(ign\.com\/videos\/\d{4}\/\d{2}\/\d{2}\/[\w-]+)/))?c(b,{iframe:[{src:"http://widgets.ign.com/video/embed/content.html?url=http://www."+a[2],allowfullscreen:"true",scrolling:"no"}]}):(a=g.match(/^([a-z]{1,3}\.)?twitch\.tv\/(\w+)\/([bc])\/(\d+)/))?c(b,{object:[{data:"http://www.twitch.tv/widgets/archive_embed_player.swf"},{allowFullScreen:"true",allowScriptAccess:"always",flashvars:"auto_play=false&channel="+a[2]+"&"+("b"==a[3]?"archive_id=":"chapter_id=")+a[4]}]}):(a=g.match(/^([a-z]{1,3}\.)?twitch\.tv\/(\w+)$/))?c(b,{object:[{data:"http://www.twitch.tv/widgets/live_embed_player.swf?channel="+a[2]},{allowFullScreen:"true",allowScriptAccess:"always",flashvars:"auto_play=false&hostname=www.twitch.tv&channel="+a[2]}]}):(a=g.match(/^g4tv\.com\/(videos|lv3)\/(\d+)/))?c(b,{object:[{data:"http://www.g4tv.com/lv3/"+a[2]},{allowFullScreen:"true",allowScriptAccess:"always"}]}):(a=g.match(/^([a-z]{1,3}\.)?gamespot\.com\/(videoembed\/|video\/\d+\/|[\w\/-]+\/video\/|[\w-]+\/videos\/[\w-]+-)(\d+)/))&&c(b,{iframe:[{src:"http://"+(a[1]?a[1]:"www.")+"gamespot.com/videoembed/"+a[3]+"&mapp=false&ads=0&onsite=0",allowfullscreen:"true"}]})}}}},init:function(){l.addEventListener?l.addEventListener("DOMContentLoaded",FluxBB.media.run(),!1):/in/.test(l.readyState)?setTimeout(FluxBB.media.init,100):FluxBB.media.run()}}}();FluxBB.media.init();